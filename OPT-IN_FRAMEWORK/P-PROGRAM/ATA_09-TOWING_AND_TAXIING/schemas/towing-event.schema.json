{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ampel360.amedeopelliccia.it/schemas/towing-event.schema.json",
  "title": "Towing Event Schema",
  "description": "Schema for towing event log entries",
  "type": "object",
  "required": ["event_id", "timestamp", "msn", "event_type", "personnel", "equipment"],
  "properties": {
    "event_id": {
      "type": "string",
      "description": "Unique identifier for the towing event"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of the towing operation"
    },
    "msn": {
      "type": "string",
      "description": "Manufacturer Serial Number"
    },
    "event_type": {
      "type": "string",
      "enum": ["tow_with_towbar", "tow_towbarless", "pushback"],
      "description": "Type of towing operation"
    },
    "personnel": {
      "type": "object",
      "required": ["ground_crew_lead", "brake_rider"],
      "properties": {
        "ground_crew_lead": {
          "type": "string",
          "description": "Name or ID of ground crew lead"
        },
        "brake_rider": {
          "type": "string",
          "description": "Name or ID of brake rider"
        },
        "tug_operator": {
          "type": "string",
          "description": "Name or ID of tug operator"
        },
        "wingwalkers": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Names or IDs of wingwalkers"
        }
      }
    },
    "equipment": {
      "type": "object",
      "required": ["tug_id"],
      "properties": {
        "tug_id": {
          "type": "string",
          "description": "Tug vehicle identifier"
        },
        "tug_dbp_kn": {
          "type": "number",
          "minimum": 0,
          "description": "Tug drawbar pull capacity in kilonewtons"
        },
        "towbar_pn": {
          "type": "string",
          "description": "Towbar part number (if applicable)"
        },
        "adapter_pn": {
          "type": "string",
          "description": "Adapter part number (if applicable)"
        }
      }
    },
    "route": {
      "type": "object",
      "properties": {
        "origin": {
          "type": "string",
          "description": "Starting position"
        },
        "destination": {
          "type": "string",
          "description": "Ending position"
        },
        "distance_m": {
          "type": "number",
          "minimum": 0,
          "description": "Towing distance in meters"
        }
      }
    },
    "conditions": {
      "type": "object",
      "properties": {
        "wind_kt": {
          "type": "number",
          "minimum": 0,
          "description": "Wind speed in knots"
        },
        "wind_direction_deg": {
          "type": "number",
          "minimum": 0,
          "maximum": 360,
          "description": "Wind direction in degrees"
        },
        "slope_pct": {
          "type": "number",
          "description": "Slope percentage"
        },
        "surface": {
          "type": "string",
          "enum": ["dry", "wet", "contaminated"],
          "description": "Surface condition"
        }
      }
    },
    "aircraft_state": {
      "type": "object",
      "properties": {
        "gross_weight_kg": {
          "type": "number",
          "minimum": 0,
          "description": "Gross weight in kilograms"
        },
        "cg_percent_mac": {
          "type": "number",
          "description": "Center of gravity as percent MAC"
        },
        "nws_pin_installed": {
          "type": "boolean",
          "description": "Whether NWS pin was installed"
        },
        "gear_pins_installed": {
          "type": "boolean",
          "description": "Whether gear downlock pins were installed"
        },
        "brake_pressure_psi": {
          "type": "number",
          "minimum": 0,
          "description": "Brake accumulator pressure in PSI"
        }
      }
    },
    "performance": {
      "type": "object",
      "properties": {
        "duration_s": {
          "type": "number",
          "minimum": 0,
          "description": "Total duration in seconds"
        },
        "max_speed_kmh": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum speed in km/h"
        },
        "max_drawbar_pull_kn": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum drawbar pull in kilonewtons"
        }
      }
    },
    "incidents": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "type": { "type": "string" },
          "description": { "type": "string" },
          "severity": { "type": "string", "enum": ["minor", "major", "critical"] }
        }
      },
      "description": "Any incidents that occurred during the operation"
    },
    "inspection_results": {
      "type": "object",
      "properties": {
        "nlg_post_inspection": {
          "type": "string",
          "enum": ["passed", "failed", "not_performed"],
          "description": "Nose landing gear post-tow inspection result"
        },
        "damage_noted": {
          "type": "boolean",
          "description": "Whether any damage was noted"
        }
      }
    },
    "notes": {
      "type": "string",
      "description": "Additional notes or observations"
    }
  }
}
